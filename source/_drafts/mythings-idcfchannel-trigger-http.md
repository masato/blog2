title: "myThingsをはじめよう - Part4: 「IDCF」チャンネルのトリガーを使って閾値を超えたらメールする。HTTP編"
date: 2015-08-27 11:52:59
tags:
---

「IDCF」チャンネルのトリガーは、Raspberry Piと環境センサーが計測した湿度が70%を超えたときなど、閾値を監視してmyThingsのトリガーを作成することができます。

## myThingsサーバーの特徴

現在のmyThingsサーバーは一定間隔でメッセージの受信を確認しています。そのためmyThingsのトリガーとして「IDCF」チャンネルを使う場合は、myThingsサーバーが非同期でメッセージを取得できるようにデータを保存しておく必要があります。

HTTPを使う場合は、`/data/uuid`にメッセージをPOSTすると「IDCF」チャンネルのMongoDBにデータが保存されます。myThingsサーバーはデータを非同期で取得できたらトリガーの条件がマッチしたと判断して、アクションを実行します。


### trigger-1へHTTP POST

コネクテッドデバイス側で閾値越えを判断したら、データを`data/uuid`にPOSTします。


### myThingsの設定

myThingsアプリから以下の組み合わせを作成します。ある閾値を超えたときに「IDCF」チャンネルのトリガーをHTTPで起動して、アクションを実行させる例です。

* トリガー: 「IDCF」チャンネル
* アクション: 「Gmail」アクション

### 「IDCF」チャンネルのアクティベーション


### 「IDCF」チャンネルのトリガー



### 「Gmail」チャンネルのアクション

あらかじめ「Gmail」


「気温が26度をこえたら」と条件をつけます。


